FTMO Bot v3 - Runbook (v1)

Requirements
- Python 3.11+
- pip

Setup
- python -m venv .venv
- source .venv/bin/activate
- python -m pip install -e .[dev]

Freeze config
- python scripts/freeze_config.py configs/ftmo_v1.yaml

Generate sample sim report (v2)
- python scripts/run_sim_report.py --config configs/ftmo_v1.yaml --output reports/sample_sim_report_v2.json

Run unit tests
- pytest -q

Run local sim demo
- python examples/demo_simulation.py

Run paper demo (idempotency + buffers)
- python examples/demo_paper.py

Run with frozen config (run_id + audit)
- python examples/run_with_config.py

Run service loop (reconcile + health checks)
- python scripts/run_service_loop.py --config configs/ftmo_v1.yaml
- state snapshots + bundles are generated by the service loop
- simulate disconnect (test-only): touch /tmp/ftmo_force_disconnect (remove to recover)

Run service loop with MT5 (requires MetaTrader5)
- python -m pip install MetaTrader5
- update configs/ftmo_v1.yaml: execution.broker: mt5
- export MT5_LOGIN=123456 MT5_PASSWORD=secret MT5_SERVER=Broker-Server
- export MT5_PATH=/path/to/terminal64.exe  # optional
- python scripts/run_service_loop.py --config configs/ftmo_v1.yaml --resume --simulate-disconnect-path /tmp/ftmo_force_disconnect

Smoke test (30–60 minutes)
- run scripts/gate_smoke.sh 30

Start the 5-day gate run
- scripts/gate_5day.sh

Generate a daily bundle (manual)
- python scripts/generate_daily_bundle.py --config configs/ftmo_v1.yaml --output-dir reports/daily_bundles

Analyze the last N bundles
- python scripts/analyze_bundles.py --bundle-root reports/daily_bundles --last 5 --output-dir reports/bundle_summary

Daily gate review
- scripts/gate_daily_check.sh

Windows (PowerShell) gate run
- scripts/gate_smoke.ps1 -Minutes 30
- scripts/gate_5day.ps1
- scripts/gate_daily_check.ps1
- crash logs: runtime\service.log (marker: runtime\service_crash.txt)
- disconnect toggle:
  $env:FTMO_FORCE_DISCONNECT = "$env:TEMP\ftmo_force_disconnect"
  New-Item -ItemType File -Path $env:FTMO_FORCE_DISCONNECT -Force
  Remove-Item $env:FTMO_FORCE_DISCONNECT

Windows (PowerShell) one-click
- smoke: scripts\gate_oneclick.ps1 -Phase smoke -Minutes 30
- 5-day start: scripts\gate_oneclick.ps1 -Phase gate
- tail logs live: add `-TailLogs`
- credentials: set `MT5_LOGIN`, `MT5_PASSWORD`, `MT5_SERVER` in your session or enter at the prompt

Simply run (Windows PowerShell, copy/paste)
1) Open PowerShell.
2) Smoke test (30 minutes, live logs):
```
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass; cd $HOME; if (!(Test-Path Omega-FX-V3)) { git clone https://github.com/Cloudwith-mo/Omega-FX-V3.git }; cd Omega-FX-V3; .\scripts\gate_oneclick.ps1 -Phase smoke -Minutes 30 -TailLogs
```
3) When prompted, enter MT5_LOGIN, MT5_SERVER, MT5_PASSWORD (local only).
4) Keep MT5 terminal open, logged in, Algo Trading enabled.
5) If smoke passes, start the 5-day run:
```
cd $HOME\Omega-FX-V3; .\scripts\gate_oneclick.ps1 -Phase gate -TailLogs
```
6) Daily check:
```
cd $HOME\Omega-FX-V3; .\scripts\gate_daily_check.ps1
```
7) Simulate disconnect (3–5 minutes):
```
New-Item -ItemType File -Path $env:TEMP\ftmo_force_disconnect -Force
Remove-Item $env:TEMP\ftmo_force_disconnect
```
8) If it crashes, show last logs:
```
Get-Content $HOME\Omega-FX-V3\runtime\service_crash.txt
Get-Content $HOME\Omega-FX-V3\runtime\service.log -Tail 200
```

Run Streamlit HUD (reads runtime/status.json by default)
- python -m pip install -e .[hud]
- streamlit run apps/hud_streamlit.py

Systemd unit (template)
- copy deploy/systemd/ftmo-bot.service to /etc/systemd/system/ftmo-bot.service
- copy deploy/systemd/ftmo-bot.env.example to /etc/ftmo-bot.env and fill credentials
- sudo systemctl daemon-reload
- sudo systemctl enable --now ftmo-bot

Generate a sample forward-test log bundle
- python scripts/generate_sample_logs.py --config configs/ftmo_v1.yaml --output-dir reports/forward_test_bundle
